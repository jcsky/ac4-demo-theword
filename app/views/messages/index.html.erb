<div class="container">

  <div class="col-md-3">
  </div>

  <div class="col-md-6">


      <%= render :partial => "edit", :locals => { :message => @message } %>

    <p></p>

    draft do{
      partial: "edit"
    }
    final do{
      partial: "show"
    }


    <!-- Message show -->
    <% @messages.each do |m| %>
      <div class="mge-show" id="mge-<%= m.id %>">
        <div class="pull-right">
          <%= m.created_at.to_s(:short) %>
          <!-- Single button -->
            <div class="btn-group">
              <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-expanded="false">
                 <span class="caret"></span>
              </button>
              <ul class="dropdown-menu" role="menu">
                <li><%= link_to '修改遺言', edit_message_url(m), remote: true %></li>
                <li><%= link_to '刪除遺言', message_path(m), :data =>{:confirm => "確定要刪除這則遺言?"}, :method => :delete, :remote => true %></li>
              </ul>
            </div>
        </div>

        <!-- <p>給: <%#= m.receivers.all.map{ |r| r.contact.name}.to_s %></p> -->
        <ul>
          <% m.receivers.all.each_with_index do |receiver, index| %>
            <li class="receiver-name receiver-<%= index %>"><%= receiver.contact.name %></li>
          <% end %>
        </ul>
        <p>指定傳送日期: <%= m.delivery_date.to_s %></p>
        <legend></legend>
        <p><%=simple_format m.content %></p>


      </div>
    <% end %>

  </div>

  <!-- Contact List -->
  <div class="col-md-3 contact-list">
    <legend class="text-center">聯絡人設定</legend>
      <p>當我們無法與您聯繫時，將聯絡以下對象</p>
      <% @contacts.each do |c| %>
        <%= link_to c.name, c, :class => "col-md-10" %>
        <%= link_to "x", c, :method => :delete, :class => "col-md-2 contact-delete" %>
      <% end %>

    <%= link_to '+', new_contact_path, :class => 'btn btn-default btn-add-contact' %>
  </div>
</div>


<script>

  $("#receivers-select").select2();

</script>
